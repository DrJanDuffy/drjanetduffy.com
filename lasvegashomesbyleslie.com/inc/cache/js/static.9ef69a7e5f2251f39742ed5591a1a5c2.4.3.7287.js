
(function(){var method;var noop=function(){};var methods=['assert','clear','count','debug','dir','dirxml','error','exception','group','groupCollapsed','groupEnd','info','log','markTimeline','profile','profileEnd','table','time','timeEnd','timeStamp','trace','warn'];var length=methods.length;var console=(window.console=window.console||{});while(length--){method=methods[length];if(!console[method]){console[method]=noop;}}}());$.support.transition=(function(){var thisBody=document.body||document.documentElement,thisStyle=thisBody.style,support=thisStyle.transition!==undefined||thisStyle.WebkitTransition!==undefined||thisStyle.MozTransition!==undefined||thisStyle.MsTransition!==undefined||thisStyle.OTransition!==undefined;return support;})();(function($){var event=$.event,resizeTimeout;event.special['smartresize']={setup:function(){$(this).bind('resize',event.special.smartresize.handler);},teardown:function(){$(this).unbind('resize',event.special.smartresize.handler);},handler:function(event,execAsap){var context=this,args=arguments;event.type='smartresize';if(resizeTimeout)clearTimeout(resizeTimeout);resizeTimeout=setTimeout(function(){jQuery.event.handle.apply(context,args);},execAsap==='execAsap'?0:100);}}
$.fn.smartresize=function(fn){return fn?this.bind('smartresize',fn):this.trigger('smartresize',['execAsap']);};})(jQuery);(function(a,b,c){"use strict";var d=b.event,e;d.special.smartresize={setup:function(){b(this).bind("resize",d.special.smartresize.handler)},teardown:function(){b(this).unbind("resize",d.special.smartresize.handler)},handler:function(a,c){var d=this,f=arguments;a.type="smartresize",e&&clearTimeout(e),e=setTimeout(function(){b.event.handle.apply(d,f)},c==="execAsap"?0:100)}},b.fn.smartresize=function(a){return a?this.bind("smartresize",a):this.trigger("smartresize",["execAsap"])},b.Mason=function(a,c){this.element=b(c),this._create(a),this._init()},b.Mason.settings={isResizable:!0,isAnimated:!1,animationOptions:{queue:!1,duration:500},gutterWidth:0,isRTL:!1,isFitWidth:!1,containerStyle:{position:"relative"}},b.Mason.prototype={_filterFindBricks:function(a){var b=this.options.itemSelector;return b?a.filter(b).add(a.find(b)):a},_getBricks:function(a){var b=this._filterFindBricks(a).css({position:"absolute"}).addClass("masonry-brick");return b},_create:function(c){this.options=b.extend(!0,{},b.Mason.settings,c),this.styleQueue=[];var d=this.element[0].style;this.originalStyle={height:d.height||""};var e=this.options.containerStyle;for(var f in e)this.originalStyle[f]=d[f]||"";this.element.css(e),this.horizontalDirection=this.options.isRTL?"right":"left",this.offset={x:parseInt(this.element.css("padding-"+this.horizontalDirection),10),y:parseInt(this.element.css("padding-top"),10)},this.isFluid=this.options.columnWidth&&typeof this.options.columnWidth=="function";var g=this;setTimeout(function(){g.element.addClass("masonry")},0),this.options.isResizable&&b(a).bind("smartresize.masonry",function(){g.resize()}),this.reloadItems()},_init:function(a){this._getColumns(),this._reLayout(a)},option:function(a,c){b.isPlainObject(a)&&(this.options=b.extend(!0,this.options,a))},layout:function(a,b){for(var c=0,d=a.length;c<d;c++)this._placeBrick(a[c]);var e={};e.height=Math.max.apply(Math,this.colYs);if(this.options.isFitWidth){var f=0;c=this.cols;while(--c){if(this.colYs[c]!==0)break;f++}e.width=(this.cols-f)*this.columnWidth-this.options.gutterWidth}this.styleQueue.push({$el:this.element,style:e});var g=this.isLaidOut?this.options.isAnimated?"animate":"css":"css",h=this.options.animationOptions,i;for(c=0,d=this.styleQueue.length;c<d;c++)i=this.styleQueue[c],i.$el[g](i.style,h);this.styleQueue=[],b&&b.call(a),this.isLaidOut=!0},_getColumns:function(){var a=this.options.isFitWidth?this.element.parent():this.element,b=a.width();this.columnWidth=this.isFluid?this.options.columnWidth(b):this.options.columnWidth||this.$bricks.outerWidth(!0)||b,this.columnWidth+=this.options.gutterWidth,this.cols=Math.floor((b+this.options.gutterWidth)/this.columnWidth),this.cols=Math.max(this.cols,1)},_placeBrick:function(a){var c=b(a),d,e,f,g,h;d=Math.ceil(c.outerWidth(!0)/this.columnWidth),d=Math.min(d,this.cols);if(d===1)f=this.colYs;else{e=this.cols+1-d,f=[];for(h=0;h<e;h++)g=this.colYs.slice(h,h+d),f[h]=Math.max.apply(Math,g)}var i=Math.min.apply(Math,f),j=0;for(var k=0,l=f.length;k<l;k++)if(f[k]===i){j=k;break}var m={top:i+this.offset.y};m[this.horizontalDirection]=this.columnWidth*j+this.offset.x,this.styleQueue.push({$el:c,style:m});var n=i+c.outerHeight(!0),o=this.cols+1-l;for(k=0;k<o;k++)this.colYs[j+k]=n},resize:function(){var a=this.cols;this._getColumns(),(this.isFluid||this.cols!==a)&&this._reLayout()},_reLayout:function(a){var b=this.cols;this.colYs=[];while(b--)this.colYs.push(0);this.layout(this.$bricks,a)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(a){this.reloadItems(),this._init(a)},appended:function(a,b,c){if(b){this._filterFindBricks(a).css({top:this.element.height()});var d=this;setTimeout(function(){d._appended(a,c)},1)}else this._appended(a,c)},_appended:function(a,b){var c=this._getBricks(a);this.$bricks=this.$bricks.add(c),this.layout(c,b)},remove:function(a){this.$bricks=this.$bricks.not(a),a.remove()},destroy:function(){this.$bricks.removeClass("masonry-brick").each(function(){this.style.position="",this.style.top="",this.style.left=""});var c=this.element[0].style;for(var d in this.originalStyle)c[d]=this.originalStyle[d];this.element.unbind(".masonry").removeClass("masonry").removeData("masonry"),b(a).unbind(".masonry")}},b.fn.imagesLoaded=function(a){function h(){a.call(c,d)}function i(a){var c=a.target;c.src!==f&&b.inArray(c,g)===-1&&(g.push(c),--e<=0&&(setTimeout(h),d.unbind(".imagesLoaded",i)))}var c=this,d=c.find("img").add(c.filter("img")),e=d.length,f="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",g=[];return e||h(),d.bind("load.imagesLoaded error.imagesLoaded",i).each(function(){var a=this.src;this.src=f,this.src=a}),c};var f=function(b){a.console&&a.console.error(b)};b.fn.masonry=function(a){if(typeof a=="string"){var c=Array.prototype.slice.call(arguments,1);this.each(function(){var d=b.data(this,"masonry");if(!d){f("cannot call methods on masonry prior to initialization; attempted to call method '"+a+"'");return}if(!b.isFunction(d[a])||a.charAt(0)==="_"){f("no such method '"+a+"' for masonry instance");return}d[a].apply(d,c)})}else this.each(function(){var c=b.data(this,"masonry");c?(c.option(a||{}),c._init()):b.data(this,"masonry",new b.Mason(a,this))});return this}})(window,jQuery);(function(w){if(!(/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf('AppleWebKit')>-1)){return;}
var doc=w.document;if(!doc.querySelector)return;var meta=doc.querySelector('meta[name=viewport]'),initialContent=meta&&meta.getAttribute('content'),disabledZoom=initialContent+',maximum-scale=1',enabledZoom=initialContent+',maximum-scale=10',enabled=true,x,y,z,aig;if(!meta)return;function restoreZoom(){meta.setAttribute('content',enabledZoom);enabled=true;}
function disableZoom(){meta.setAttribute('content',disabledZoom);enabled=false;}
function checkTilt(e){aig=e.accelerationIncludingGravity;x=Math.abs(aig.x);y=Math.abs(aig.y);z=Math.abs(aig.z);if((!w.orientation||w.orientation===180)&&(x>7||((z>6&&y<8||z<8&&y>6)&&x>5))){if(enabled){disableZoom();}}else if(!enabled){restoreZoom();}}
w.addEventListener('orientationchange',restoreZoom,false);w.addEventListener('devicemotion',checkTilt,false);})(this);(function(){jQuery.fn.eqHeight=function(){return this.each(function(i,v){var tallest=0;var $cols=$(this).children().css('min-height','auto');$cols.each(function(){var height=$(this).outerHeight();if(height>tallest)tallest=height;});$cols.css('min-height',tallest+2);});};})();(function($){$.fn.touchwipe=function(settings){var config={min_move_x:20,min_move_y:20,wipeLeft:function(e){},wipeRight:function(e){},wipeUp:function(e){},wipeDown:function(e){},preventDefaultEvents:true};if(settings)$.extend(config,settings);this.each(function(){var startX;var startY;var isMoving=false;function cancelTouch(){this.removeEventListener('touchmove',onTouchMove);startX=null;isMoving=false;}
function onTouchMove(e){if(config.preventDefaultEvents){e.preventDefault();}
if(isMoving){var x=e.touches[0].pageX;var y=e.touches[0].pageY;var dx=startX-x;var dy=startY-y;if(Math.abs(dx)>=config.min_move_x){cancelTouch();if(dx>0){config.wipeLeft(e);}else{config.wipeRight(e);}}else if(Math.abs(dy)>=config.min_move_y){cancelTouch();if(dy>0){config.wipeDown(e);}else{config.wipeUp(e);}}}}
function onTouchStart(e){if(e.touches.length==1){startX=e.touches[0].pageX;startY=e.touches[0].pageY;isMoving=true;this.addEventListener('touchmove',onTouchMove,false);}}
if('ontouchstart'in document.documentElement){this.addEventListener('touchstart',onTouchStart,false);}});return this;};})(jQuery);;(function(window,document,$){var isInputSupported='placeholder'in document.createElement('input'),isTextareaSupported='placeholder'in document.createElement('textarea'),prototype=$.fn,valHooks=$.valHooks,hooks,placeholder;if(isInputSupported&&isTextareaSupported){placeholder=prototype.placeholder=function(){return this;};placeholder.input=placeholder.textarea=true;}else{placeholder=prototype.placeholder=function(){var $this=this;$this.filter((isInputSupported?'textarea':':input')+'[placeholder]').not('.placeholder').bind({'focus.placeholder':clearPlaceholder,'blur.placeholder':setPlaceholder}).data('placeholder-enabled',true).trigger('blur.placeholder');return $this;};placeholder.input=isInputSupported;placeholder.textarea=isTextareaSupported;hooks={'get':function(element){var $element=$(element);return $element.data('placeholder-enabled')&&$element.hasClass('placeholder')?'':element.value;},'set':function(element,value){var $element=$(element);if(!$element.data('placeholder-enabled')){return element.value=value;}
if(value==''){element.value=value;if(element!=document.activeElement){setPlaceholder.call(element);}}else if($element.hasClass('placeholder')){clearPlaceholder.call(element,true,value)||(element.value=value);}else{element.value=value;}
return $element;}};isInputSupported||(valHooks.input=hooks);isTextareaSupported||(valHooks.textarea=hooks);$(function(){$(document).delegate('form','submit.placeholder',function(){var $inputs=$('.placeholder',this).each(clearPlaceholder);setTimeout(function(){$inputs.each(setPlaceholder);},10);});});$(window).bind('beforeunload.placeholder',function(){$('.placeholder').each(function(){this.value='';});});}
function args(elem){var newAttrs={},rinlinejQuery=/^jQuery\d+$/;$.each(elem.attributes,function(i,attr){if(attr.specified&&!rinlinejQuery.test(attr.name)){newAttrs[attr.name]=attr.value;}});return newAttrs;}
function clearPlaceholder(event,value){var input=this,$input=$(input);if(input.value==$input.attr('placeholder')&&$input.hasClass('placeholder')){if($input.data('placeholder-password')){$input=$input.hide().next().show().attr('id',$input.removeAttr('id').data('placeholder-id'));if(event===true){return $input[0].value=value;}
$input.focus();}else{input.value='';$input.removeClass('placeholder');input==document.activeElement&&input.select();}}}
function setPlaceholder(){var $replacement,input=this,$input=$(input),$origInput=$input,id=this.id;if(input.value==''){if(input.type=='password'){if(!$input.data('placeholder-textinput')){try{$replacement=$input.clone().attr({'type':'text'});}catch(e){$replacement=$('<input>').attr($.extend(args(this),{'type':'text'}));}
$replacement.removeAttr('name').data({'placeholder-password':true,'placeholder-id':id}).bind('focus.placeholder',clearPlaceholder);$input.data({'placeholder-textinput':$replacement,'placeholder-id':id}).before($replacement);}
$input=$input.removeAttr('id').hide().prev().attr('id',id).show();}
$input.addClass('placeholder');$input[0].value=$input.attr('placeholder');}else{$input.removeClass('placeholder');}}}(this,document,jQuery));var BREW={mobile:navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry)/)?true:false,events:{click:'click'}};BREW.Cookie=function(key,value,options){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(value))||value===null||value===undefined)){options=$.extend({},options);if(value===null||value===undefined){options.expires=-1;}
if(typeof options.expires==='number'){var days=options.expires,t=options.expires=new Date();t.setDate(t.getDate()+days);}
value=String(value);return(document.cookie=[encodeURIComponent(key),'=',options.raw?value:encodeURIComponent(value),options.expires?'; expires='+options.expires.toUTCString():'',options.path?'; path='+options.path:'',options.domain?'; domain='+options.domain:'',options.secure?'; secure':''].join(''));}
options=value||{};var decode=options.raw?function(s){return s;}:decodeURIComponent;var pairs=document.cookie.split('; ');for(var i=0,pair;pair=pairs[i]&&pairs[i].split('=');i++){if(decode(pair[0])===key)return decode(pair[1]||'');}
return null;};BREW.Splitlist=function(el,options){var options=$.extend({columns:3},options);var $el=$(el),items=$el.children(),tag=$el.get(0).tagName.toLowerCase(),rows=Math.ceil(items.length/options.columns);var $list=$el;for(var i=1;i<items.length/rows;i++){var $new=$(document.createElement(tag));for(var j=rows*i;j<(rows*i)+rows;j++){$new.append(items[j]);}
$new.attr('class',$list.attr('class'));$list.after($new);$list=$new;}};$.fn.Splitlist=function(options){return this.each(function(){(new BREW.Splitlist(this,options));});};BREW.Resize=function(el,options){var self=this,$el=$(el);var self=this,$el=$(el),$canvas=$el.parent();var options=$.extend({method:'scale',ratio:'3:4',className:'brewImage',bgColor:'#222'},options);var opts=$canvas.data('resize');if(opts)$.extend(options,opts);var ratio=options.ratio.split(':'),shimHPercent=(ratio[0]/ratio[1])*100;var $shim=$('<div class="shim"/>');$shim.css({'padding-bottom':shimHPercent+'%'}).insertAfter($el);$canvas.addClass(options.className).css({'background':options.bgColor});self.pixelsToPercent=function(chi,par){return((parseInt(chi,10)/parseInt(par,10))*100)+'%';};self.resize=function(){var resizeMe=function(){$el.css({'position':'absolute','max-width':'9999em','height':'auto','width':'auto'});var imgHeight=$el.height(),imgWidth=$el.width(),imgHPercent=(imgHeight/imgWidth)*100;if(imgHeight<=0){throw{message:'Height Error'};}
$el.attr('style','');var landscape=(shimHPercent>=imgHPercent);$el.addClass(landscape?'landscape':'portrait').addClass(options.method);var canvasHeight=$canvas.height(),canvasWidth=$canvas.width();if(options.method==='crop'){if(landscape){var left=(canvasWidth-$el.width())/2;$el.css({'left':self.pixelsToPercent(left,canvasWidth),'top':0});}else{var top=($el.height()-canvasHeight)/2;$el.css({'top':self.pixelsToPercent(top*-1,canvasHeight),'left':0});}}else if(options.method==='scale'){if(landscape){var top=($el.height()-canvasHeight)/2;$el.css({'top':self.pixelsToPercent(top*-1,canvasHeight),'left':0});}else{var left=(canvasWidth-$el.width())/2;$el.css({'left':self.pixelsToPercent(left,canvasWidth),'top':0});}}};try{resizeMe();}catch(e){setTimeout(function(){try{resizeMe();}catch(e){}},1000);}};if(el.nodeType===1&&el.tagName.toLowerCase()==='img'&&el.src!==''){$el.addClass('hidden');self.resize($el);$el.removeClass('hidden');}};$.fn.Resize=function(options){var ns='BREW.Resize';var methods={resize:function(row){$(this).data(ns).resize;}};if(methods[options]){return methods[options].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof options==='object'||!options){return this.each(function(){var $this=$(this);if(undefined==$this.data(ns)){var plugin=new BREW.Resize(this,options);$this.data(ns,plugin);}});}};BREW.Images=function(el,options){var $el=$(el);var options=$.extend({resize:{method:'scale'},onComplete:null,onLoad:function(el){var opts=this,$img=$(el);$img.Resize(opts.resize);}},options);if($el.is('img'))$el=$el.parent();var $imgs=$el.find('img[data-src]'),imgs=[];$imgs.each(function(){imgs.push(this);});var total=imgs.length,loaded=0;$.each(imgs,function(i,img){var $img=$(img);var src=$img.attr('data-src');if($img.attr('src')===src){if(options.onLoad)options.onLoad(img);if(total===++loaded&&options.onComplete)options.onComplete($imgs);return true;}
var $canvas=$img.parent().addClass('stateLoading'),image=new Image();$(image).bind('load.images error.images',function(e){$canvas.removeClass('stateLoading');img.src=image.src;if(!$img.hasClass('loaded')){$img.addClass('loaded');if(e.type==='load'&&options.onLoad)options.onLoad(img);}
if(total===++loaded&&options.onComplete)options.onComplete($imgs);});$img.attr('data-org',img.src);image.src=$img.attr('data-src');});};$.fn.Images=function(options){return this.each(function(){(new BREW.Images(this,options));});};BREW.Gallery=function(el,options){var self=this,$el=$(el);var options=$.extend({current:0,prevBtn:'a.prev',nextBtn:'a.next',playBtn:'a.play',stopBtn:'a.stop',toggleBtn:'a.toggle',fullscreen:false,repeat:true,autoplay:true,interval:5000,paginate:'dots',onInit:null,onPlay:null,onStop:null,onChange:null,onClick:function(el){if(options.fullscreen){var el=$(el).find('img').get(0);if(el.requestFullScreen){el.requestFullScreen();}else if(el.mozRequestFullScreen){el.mozRequestFullScreen();}else if(el.webkitRequestFullScreen){el.webkitRequestFullScreen();}}}},options);var $slides=$el.find('.slideset').children('.slide');self.current=options.current;self.firstrun=true;self.init=function(){var i=$slides.length;while(i--)$($slides[i]).addClass('hidden');setTimeout(function(){$el.addClass('init');self.setSlide(self.current);},0);self.bindEvents();if(options.paginate)self.buildPagination();if(typeof options.onInit=='function')options.onInit.call(this);};self.setSlide=function(index,stop){var slide=self.getSlide(index),$slide=$(slide),$last=$slides.not('.hidden');if(stop)self.stop();if(!$slide.hasClass('hidden'))return;$slide.Images({onComplete:$.proxy(function(el){self.current=index;$slide.removeClass('hidden').addClass('current');if($last)$last.addClass('hidden').removeClass('current');if(options.paginate)$el.find('a[data-page="'+index+'"]').parent().addClass('current').siblings().removeClass('current');if(self.firstrun&&options.autoplay){self.firstrun=false;self.play();}
if(typeof options.onChange=='function')options.onChange.call(this);},this)});};self.getSlide=function(index){var index=index!=null?index:self.current;return $slides.get(index);};self.prev=function(){if(self.current>0){self.setSlide(self.current-1);}else if(options.repeat){self.setSlide($slides.length-1);}};self.next=function(){if(self.current+1<$slides.length){self.setSlide(self.current+1);}else if(options.repeat){self.setSlide(0);}};self.play=function(){if(self.timeout)clearInterval(self.timeout);self.timeout=setInterval(self.next,options.interval);if(typeof options.onPlay=='function')options.onPlay.call(this);};self.stop=function(){if(self.timeout)clearInterval(self.timeout);if(typeof options.onStop=='function')options.onStop.call(this);};self.buildPagination=function(){var len=$slides.length,links=[];for(i=0;i<len;i++){links.push('<li'+(self.current==i?' class="current"':'')+'><a href="javascript:void(0);" data-page="'+i+'">'+(i+1)+'</a></li>');}
var $nav=$el.find('.pagination');switch(options.paginate){case'dots':$nav.addClass('dots');break;case'nums':$nav.addClass('nums');break;}
$nav.append(links.join(''));$el.find('.nav').append($nav);$nav.on(BREW.events.click+'.gallery','a',function(e){e.preventDefault();var $this=$(this),page=$this.attr('data-page');self.setSlide(page);self.stop();});};self.bindEvents=function(){$el.on(BREW.events.click+'.gallery',options.prevBtn,function(e){e.preventDefault();self.prev();self.stop();});$el.on(BREW.events.click+'.gallery',options.nextBtn,function(e){e.preventDefault();self.next();self.stop();});$el.on(BREW.events.click+'.gallery',options.playBtn,function(e){e.preventDefault();self.play();});$el.on(BREW.events.click+'.gallery',options.stopBtn,function(e){e.preventDefault();self.stop();});$el.on(BREW.events.click+'.gallery',options.toggleBtn,function(e){e.preventDefault();var ico=$(this).find('.ico');if(ico.hasClass('icon-pause')){ico.addClass('icon-play').removeClass('icon-pause');self.stop();}else{ico.addClass('icon-pause').removeClass('icon-play');self.play();}});$slides.on(BREW.events.click+'.gallery',function(e){if(options.onClick)options.onClick(this);if(this.tagName.toLowerCase()!=='a'){e.preventDefault();}});if(BREW.mobile){$el.touchwipe({preventDefaultEvents:false,wipeLeft:function(){self.next();self.stop();},wipeRight:function(){self.prev();self.stop();}});}};self.init();};$.fn.Gallery=function(options){var ns='BREW.Gallery';var methods={setSlide:function(index,stop){$(this).data(ns).setSlide(index,stop);},getSlide:function(index){return $(this).data(ns).getSlide(index);},prev:function(){$(this).data(ns).prev();},next:function(){$(this).data(ns).next();},stop:function(){$(this).data(ns).stop();},play:function(){$(this).data(ns).play();}};if(methods[options]){return methods[options].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof options==='object'||!options){return this.each(function(){var $this=$(this);if(undefined==$this.data(ns)){var plugin=new BREW.Gallery(this,options);$this.data(ns,plugin);}});}};BREW.Carousel=function(el,options){var self=this,$el=$(el);var options=$.extend({prevBtn:'a.prev',nextBtn:'a.next',paginate:'dots',columns:0,slideHeight:'81px',slideWidth:'108px',repeat:false,fullscreen:false,onHover:null,onClick:function(el){if(options.fullscreen){var el=$(el).find('img').get(0);if(el.requestFullScreen){el.requestFullScreen();}else if(el.mozRequestFullScreen){el.mozRequestFullScreen();}else if(el.webkitRequestFullScreen){el.webkitRequestFullScreen();}}}},options);var $row=$el.find('.slideset').wrap('<div class="wrap"></div>'),$imgs=$row.find('div');self.row=0;self.rows=0;self.init=function(){var rowWidth=0,maxWidth=$el.width();if(options.columns>0){var $col=$('<div class="slidesetcol" />').css('float','left'),c=options.columns,i=0,l=$imgs.length;for(i;i<l;i+=c)$imgs.slice(i,i+c).wrapAll($col);var baseSize=800,baseGutter=20,numberofCols=Math.ceil($imgs.length/options.columns);mainContainerPixelW=((baseSize+baseGutter)*numberofCols)-baseGutter,mainContainerPercentW=(mainContainerPixelW/baseSize)*100,colContainerPixelW=baseSize,colContainerPercentW=(colContainerPixelW/mainContainerPixelW)*100,colContainerPercentG=(baseGutter/mainContainerPixelW)*100,slidePixelW=((baseSize+baseGutter)/options.columns)-baseGutter,slidePercentW=(slidePixelW/baseSize)*100,slidePercentG=(baseGutter/baseSize)*100;$el.find('.slideset').css('width',mainContainerPercentW+'%');$el.find('.slidesetcol').css('width',colContainerPercentW+'%').not(':last-child').css('margin-right',colContainerPercentG+'%');$el.find('.slide').css('width',slidePercentW+'%').not(':last-child').css('margin-right',slidePercentG+'%');var tallest=0;$el.find('.slidesetcol').each(function(){var x=$(this).outerHeight(true);if(x>tallest)tallest=x;});$el.find('.wrap').css('height',tallest).find('.prev,.next').each(function(){var $this=$(this);$this.css('margin-top','-'+$this.height()/2);});}else{if(options.slideHeight&&options.slideWidth){$el.find('.slide').css({height:options.slideHeight,width:options.slideWidth});}}
$row.Images({onComplete:function(el){$imgs.each(function(){var $this=$(this),width=$this.width()+parseInt($this.css('margin-right'));rowWidth+=width;if(rowWidth>maxWidth&&width<rowWidth){rowWidth=width;self.rows++;}
$this.attr('data-row',self.rows);});$el.removeClass('hidden');if(options.paginate)self.buildPagination();self.bindEvents();}});};self.buildPagination=function(){var $nav=$el.find('.pagination');switch(options.paginate){case'dots':$nav.addClass('dots');break;case'nums':$nav.addClass('nums');break;}
$nav.on(BREW.events.click+'.carousel','a',function(e){e.preventDefault();var $this=$(this),row=$this.attr('data-row');self.setRow(row);});self.updatePagination();};self.updatePagination=function(){var links=[],i=0;for(i;i<=self.rows;i++){links.push('<li'+(self.row==i?' class="current"':'')+'><a href="javascript:void(0);" data-row="'+i+'">'+(i+1)+'</a></li>');}
var $pagination=$el.find('.pagination');$pagination.toggleClass('hidden',i<2);$pagination.html(links.join(''));};self.setRow=function(row){if(options.columns>0){$el.find('.slideset').css('left','-'+$el.find('.slidesetcol').eq(row).position().left/$el.find('.wrap').width()*100+'%');self.row=parseInt(row);if(options.paginate){$el.find('.prev, .next').show();if(self.row===0)$el.find('.prev').hide().siblings('a').show();if(self.row===$el.find('.slidesetcol').length-1)$el.find('.next').hide();}}else{var $img=$imgs.filter('[data-row='+row+']:first');if($img.length>0){var left=$img.position().left;if($.support.transition){$row.css('left',-left);}else{$row.animate({'left':-left});}}
if(options.paginate)$el.find('a[data-row="'+row+'"]').parent().addClass('current').siblings().removeClass('current');self.row=parseInt(row);}};self.prev=function(){if(self.row>0){self.setRow(self.row-1);}else if(options.repeat){self.setRow(self.rows);}};self.next=function(){if(self.row<self.rows){self.setRow(self.row+1);}else if(options.repeat){self.setRow(0);}};self.bindEvents=function(){if(options.columns>0){$(window).bind('smartresize.carousel',function(){var rowWidth=0,maxWidth=$el.width();self.rows=0;$imgs.each(function(){var $this=$(this),width=$this.width()+parseInt($this.css('margin-right'));rowWidth+=width;if(rowWidth>maxWidth&&width<rowWidth){rowWidth=width;self.rows++;}
$this.attr('data-row',self.rows);});if(options.paginate)self.updatePagination();});}
$el.on(BREW.events.click+'.carousel',options.prevBtn,function(e){e.preventDefault();self.prev();});$el.on(BREW.events.click+'.carousel',options.nextBtn,function(e){e.preventDefault();self.next();});$imgs.on('mouseenter.carousel',function(e){if(options.onHover)options.onHover(this);e.preventDefault();});$imgs.on(BREW.events.click+'.carousel',function(e){if(options.onClick)options.onClick(this);});if(BREW.mobile){$el.touchwipe({wipeLeft:function(){self.next();self.stop();},wipeRight:function(){self.prev();self.stop();}});}};self.init();};$.fn.Carousel=function(options){var ns='BREW.Carousel';var methods={setRow:function(row){$(this).data(ns).setRow(row);},prev:function(){$(this).data(ns).prev();},next:function(){$(this).data(ns).next();}};if(methods[options]){return methods[options].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof options==='object'||!options){return this.each(function(){var $this=$(this);if(undefined==$this.data(ns)){var plugin=new BREW.Carousel(this,options);$this.data(ns,plugin);}});}};BREW.Menu=function(el,options){var self=this,$el=$(el);var options=$.extend({onOpen:null,onClose:null,onClick:null},options);var $btn=$el.find('>.btn'),$menu=$el.find('.menu');self.init=function(){self.bindEvents();};self.open=function(){$menu.removeClass('hidden');if(options.onOpen)options.onOpen(this);};self.close=function(){$menu.addClass('hidden');if(options.onClose)options.onClose(this);};self.toggle=function(e){e.preventDefault();if($menu.hasClass('hidden')){self.open();}else{self.close();}};self.bindEvents=function(){$(document).bind(BREW.events.click+'.menu',function(e){var $t=$(e.target).closest('.trigger');if($t.get(0)!=el){self.close();}});$btn.on(BREW.events.click+'.menu',self.toggle);$menu.on('li',BREW.events.click+'.menu',function(e){if(options.onClick)options.onClick(this);e.preventDefault();});};self.init();};$.fn.Menu=function(options){var ns='BREW.Menu';var methods={open:function(){$(this).data(ns).open();},close:function(){$(this).data(ns).close();}};if(methods[options]){return methods[options].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof options==='object'||!options){return this.each(function(){var $this=$(this);if(undefined==$this.data(ns)){var plugin=new BREW.Menu(this,options);$this.data(ns,plugin);}});}};BREW.Window=function(el,options){var self=this,$el=$(el);var options=$.extend({ajax:null,iframe:null,header:true,title:null,content:null,open:true,overlay:true,closeOnEscape:true,closeOnClick:false,stack:false,onOpen:null,onClose:null,closeBtn:true,width:'auto',height:'auto',noClose:false},options);var $overlay=$('<div class="overlay" />');self.init=function(){var css={};if(options.width)css.width=options.width;if(options.height)css.height=options.height;$el.addClass('init').css(css);if(options.stack)$el.addClass('stacked');$el.appendTo('body');if(options.open)self.open();self.bindEvents();};self.getWindow=function(){return $el;};self.addOverlay=function(){$overlay.appendTo(document.body);}
self.removeOverlay=function(){$overlay.remove();};self.getTitle=function(){return $el.find('header .title').html();};self.getContents=function(){return $el.find('div.pane').html();};self.setTitle=function(title){$el.find('header .title').html(title);};self.setContents=function(contents){$el.find('div.pane').html(contents);};self.position=function(){var maxHeight=$(window).height();var origHeight=$el.outerHeight();var height=maxHeight>0&&origHeight>maxHeight?maxHeight:origHeight;if($el.hasClass('positioned')){$el.animate({'margin-top':-(height!==false?height/2:$el.outerHeight()/2)+'px','margin-left':-($el.outerWidth()/2)+'px'},'fast');}else{$el.css({'margin-top':-(height!==false?height/2:$el.outerHeight()/2)+'px','margin-left':-($el.outerWidth()/2)+'px'}).addClass('positioned');}};self.open=function(){if($el.hasClass('hidden')){$('.window.init:not(.stacked)').not($el).Window('close');self.position();$el.removeClass('hidden');$('body').addClass('mute');if(options.overlay)self.addOverlay();if(options.onOpen)options.onOpen(this);$('html, body').scrollTop(0);}};self.close=function(){$el.remove();$('body').removeClass('mute');if(options.overlay)self.removeOverlay();if(options.onClose)options.onClose(this);};self.bindEvents=function(){setTimeout(function(){$(document).on(BREW.events.click+'.window',function(e){var $t=$(e.target).closest('.uiWindow');$t.get(0)!=el&&options.closeOnClick&&self.close();$(document).off(BREW.events.click+'.window');});},100);$(document).on('keyup.window',function(e){options.closeOnEscape&&e.which==27&&self.close();});if(options.closeBtn){$el.on(BREW.events.click+'.window','header .btnset',function(e){e.preventDefault();self.close();});}
$(window).bind('smartresize.window',self.position);};self.init();};$.Window=$.fn.Window=function(options){var ns='BREW.Window',options=options?options:{};if(options.noClose){var options=$.extend({closeBtn:false,closeOnClick:false,closeOnEscape:false},options);}
var methods={setTitle:function(title){this.setTitle(title);},addOverlay:function(){this.addOverlay();},removeOverlay:function(){this.removeOverlay();},position:function(){this.position();},open:function(){this.open();},close:function(){this.close();}};var createWindow=function(options){return $('<div class="window'+(options.iframe?' iframe':'')+' hidden">'+
(options.header===false?'':'<header>'+'<h4 class="title">'+(options.title?options.title:'&nbsp;')+'</h4>'+
(options.closeBtn!==false?'<div class="btnset"><a class="close btn"><i class="icon-remove"></i></a></div>':'')+'</header>')+'<div class="pane">'+(options.content?options.content:'')+'</div>'+'</div>');};if(!(this instanceof $)&&typeof(options)!='string'){if(options.ajax){$.ajax({url:options.ajax,type:'get',dataType:'html',success:function(html){var $html=$(html),title=$html.filter('title').text(),html=$html.find('#content').html();options.title=title;options.content=html
var $el=createWindow(options);return $el.Window(options);}});}else if(options.iframe){options.iframe=(options.iframe.indexOf('?')!=-1?options.iframe+'&':options.iframe+'?')+'popup';var options=$.extend(options,{width:800,open:false,content:'<iframe src="'+options.iframe+'" width="100%" frameborder="0"></iframe>'}),$el=createWindow(options);$el.find('iframe').on('load',function(){var doc=this.contentWindow.document,docTitle=doc.title,$body=$('body',doc),height=$body.height();var h=$(window).height()-50;height=(h<height)?h-10:height+10;$(this).height(height);$el.height(height+(options.header===false?0:35));$el.Window('open');setTimeout(function(){$el.Window('setTitle',docTitle);$el.Window('position');$body.find('a').each(function(){var $this=$(this),href=$this.attr('href'),target=$this.attr('target');if(target!='_blank'&&target!='_parent'&&href&&href.length>0&&href.indexOf('javascript:')!==0&&href.indexOf('#')!==0){$this.attr('href',(href.indexOf('?')!=-1?href+'&':href+'?')+'popup');}});$body.find('form').each(function(){var $this=$(this),action=$this.attr('action');if(action&&action.length>0){$this.attr('action',(action.indexOf('?')!=-1?action+'&':action+'?')+'popup');}
$this.on('submit',function(){return true;});});},100);});$window=$el.Window(options);$window.Window('addOverlay');$('html, body').scrollTop(0);return $window;}else{var $el=createWindow(options);return $el.Window(options);}}
if(typeof(options)=='string'&&methods[options]){if(!(this instanceof $)){$('.window.init').each(function(){var win=$(this).data(ns);if(win)methods[options].apply(win,Array.prototype.slice.call(arguments,1))});return;}
var win=$(this).data(ns);if(win)return methods[options].apply(win,Array.prototype.slice.call(arguments,1));}else if(typeof options==='object'||!options){return this.each(function(){var $this=$(this);if(undefined==$this.data(ns)){var plugin=new BREW.Window(this,options);$this.data(ns,plugin);}});}};BREW.Autocomplete=function(el,options){var options=$.extend({url:'/idx/inc/php/ajax/json.php',limit:10,multiple:false,params:{}},options);var self=this,$input=$(el).attr('autocomplete','off').wrap('<div class="ac-input"></div>'),$wrap=$input.closest('.ac-input');self.init=function(){$input.on('focus.ac-input',self.open).on('keypress.ac-input',self.keypress).on('keyup.ac-input',self.keyup);$wrap.on(BREW.events.click+'.ac-input','.menu label',self.click).on('mouseenter.ac-input','.menu label',self.hover);if($.browser.webkit||$.browser.msie){$input.on('keydown.ac-input',self.keypress);}};self.hover=function(){self.setActive($(this));};self.click=function(){self.setActive($(this),true);};self.select=function(){var $labels=$input.closest('.ac-input').find('.menu label'),$active=$labels.filter('.active'),$label=$active.length?$active:$labels.first();if($label.length){var value=$label.data('ac-value');if(options.multiple){var terms=$input.val().split(/,\s*/);terms.pop();terms.push(value);terms.push('');$input.val(terms.join(', ')).trigger('focus.ac-input');}else{$input.val(value);}
self.close();$input.data('ac-data',null);}};self.isActive=function(){var $menu=$input.closest('.ac-input').find('.menu');if($menu.length){if($menu.hasClass('hidden')){return false;}else{return true;}}
return false;};self.setActive=function($label,select){$label.addClass('active').siblings('label').removeClass('active');if(select)self.select();};self.next=function(){var $labels=$input.closest('.ac-input').find('.menu label'),$active=$labels.filter('.active').next('label');$label=$active.length?$active:$labels.first();self.setActive($label);};self.prev=function(){var $labels=$input.closest('.ac-input').find('.menu label'),$active=$labels.filter('.active').prev('label'),$label=$active.length?$active:$labels.last();self.setActive($label);};self.open=function(){$input.siblings('.menu').removeClass('hidden');$(document).on(BREW.events.click+'.ac-input',function(e){var $t=$(e.target).closest('.ac-input');if($t.length==1)return;$(document).off(BREW.events.click+'.ac-input');self.close();});};self.close=function(){$input.closest('.ac-input').find('.menu').addClass('hidden');};self.keypress=function(e){switch(e.keyCode){case 9:case 13:case 27:if(self.isActive()){e.preventDefault();}
break;case 38:e.preventDefault();self.prev();break;case 40:e.preventDefault();self.next();break;}
e.stopPropagation();};self.keyup=function(e){switch(e.keyCode){case 38:case 40:break;case 27:self.close();break;case 9:case 13:if(self.isActive()){self.select();}
break;default:self.query(this.value);}
e.stopPropagation();e.preventDefault();};self.highlight=function(query,item){var query=query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,'\\$&');return item.replace(new RegExp('(^'+query+')','ig'),function($1,match){return'<em>'+match+'</em>';});};self.query=function(q){var params=typeof(options.params)=='function'?options.params.call():options.params,data=$.extend(params,{q:options.multiple?q.split(/,\s*/).pop():q}),query=data.q;if(data.q.length<1)return;var last=$input.data('ac-data');if(last&&last.q==data.q&&last.search_city&&last.search_city.join(',')==data.search_city.join(','))return;$input.data('ac-data',data);var search=$input.data('ac-search');if(search)clearTimeout(search);$input.addClass('loading').data('ac-search',setTimeout(function(){var ajax=$input.data('ac-ajax');if(ajax)ajax.abort();$input.data('ac-ajax',$.ajax({'url':options.url,'type':'get','data':$.extend({},data,{limit:options.limit,search:$input.attr('name')}),'dataType':'json','success':function(data){if(typeof(data.options)=='undefined')return;$wrap.find('.menu').remove();if(data.options.length>0){var menu='<div class="menu toggleset">';$.each(data.options,function(){menu+='<label data-ac-value="'+this.value+'">'+self.highlight(query,this.title)+'</label>';});menu+='</div>';$wrap.append(menu);$input.removeClass('loading').trigger('focus.ac-input');}}}));},250));};self.init();};$.fn.Autocomplete=function(options){var ns='BREW.Autocomplete';var methods={};if(methods[options]){return methods[options].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof options==='object'||!options){return this.each(function(){var $this=$(this);if(undefined==$this.data(ns)){var plugin=new BREW.Autocomplete(this,options);$this.data(ns,plugin);}});}};BREW.Truncate=function(el,options){var options=$.extend({count:600,ending:'...',moreText:'more &raquo;',lessText:'&laquo; less '},options);var $el=$(el),fullText=$el.html(),truncText=$el.html().substring(0,options.count).split(" ").slice(0,-1).join(" ")+options.ending;if(fullText.length<options.count){return;}
$el.html(truncText+' <a href="#" class="more">'+options.moreText+'</a>');$el.find('a.more').live('click',function(){$el.html(fullText+' <a href="#" class="less">'+options.lessText+'</a>');return false;});$el.find('a.less').live('click',function(){$el.html(truncText+' <a href="#" class="more"">'+options.moreText+'</a>');return false;});};$.fn.Truncate=function(options){return this.each(function(){(new BREW.Truncate(this,options));});};var IDX={};(function($){IDX.Favorite=function(options,el){var options=$.extend({feed:null,mls:null,force:null,onComplete:null},options);$.ajax({'url':'/idx/inc/php/ajax/json.php?bookmarkListing','type':'POST','dataType':'json','data':{'feed':options.feed?options.feed:'','mls_number':options.mls?options.mls:'','force':options.force?options.force:''},'success':function(json,textStatus){if(json.returnCode==200){if(json.added&&el){$(el).addClass('saved');}else if(json.removed&&el){$(el).removeClass('saved');}}else{if(json.register){$.Window({iframe:json.register});}else{alert('An error has occurred. Listing could not be saved.');}}
if(options.onComplete)options.onComplete(json);return;}});};$.fn.Favorite=function(options){return this.each(function(){(new IDX.Favorite(options,this));});};})(jQuery);Number.prototype.format=function(c,d,t){var n=this,c=isNaN(c=Math.abs(c))?0:c,d=d==undefined?'.':d,t=t==undefined?',':t,s=n<0?'-':'',i=parseInt(n=Math.abs(+n||0).toFixed(c))+'',j=(j=i.length)>3?j%3:0;return s+(j?i.substr(0,j)+t:'')+i.substr(j).replace(/(\d{3})(?=\d)/g,"$1"+t)+(c?d+Math.abs(n-i).toFixed(c).slice(2):'');};var rew_setCookie=function(name,value,expires){return BREW.Cookie(name,value,{expires:expires});};var rew_getCookie=function(name){var cookie=BREW.Cookie(name)||'';return cookie;};var bookmarkListing=function(feed,mls,el,force){var opts={'mls':mls,'force':force,'feed':feed};if(el){$(el).Favorite(opts);}else{IDX.Favorite(opts);}};var openPage=function(url){$.Window({iframe:url});};var saveSearch=function(search){var search=$.extend(search,{search_title:search.search_title?search.search_title:(search.save_prompt?search.save_prompt:'')});var html=['<p class="msg">Save this search to receive updates of new listings.</p>','<form>','<div class="field x12">','<label>Search Title</label>','<input name="search_title" value="'+(search.search_title.length>0?search.search_title:'My Saved Search')+'" required>','</div>','<div class="field x12">','<label>Email Frequency</label>','<select name="frequency">','<option value="weekly"'+(!search.frequency||search.frequency=='weekly'?' selected':'')+'>Weekly</option>','<option selected value="daily"'+(search.frequency=='daily'?' selected':'')+'>Daily</option>','<option value="monthly"'+(search.frequency=='monthly'?' selected':'')+'>Monthly</option>','</select>','</div>','<div class="btnset">','<button type="submit" class="strong">Save Search</button>','</div>','</form>'];$.Window({open:true,width:400,title:'Save this Search',content:html.join("\n"),onOpen:function(win){var criteria=search,$el=win.getWindow(),$msg=$el.find('.msg'),$form=$el.find('form').on('submit',function(){$msg.removeClass('positive negative').addClass('caution').html('Processing Request...');var search=$.extend(criteria,{search_title:$form.find('input[name="search_title"]').val(),frequency:$form.find('select[name="frequency"]').val(),save_search:true});$.ajax({'url':'/idx/inc/php/ajax/json.php?saveSearch','type':'POST','dataType':'json','data':search,'success':function(json,textStatus){if(typeof(json)=='undefined'||!json)return;if(json.success){$msg.html(json.success).addClass('positive').removeClass('caution');if(search.create_search&&search.lead_id){window.location='/backend/leads/lead/searches/?id='+search.lead_id;}else{if(json.search)window.location='/idx/search/'+json.search+'/';}}else{if(json.error){$msg.html(json.error).addClass('negative').removeClass('caution');}
if(json.redirect){$.Window({iframe:json.redirect});}}}});return false;});if(search.trigger)$form.trigger('submit');}});return;};var editSearch=function(search){search=search?search:{};$.ajax({'url':'/idx/inc/php/ajax/json.php?editSearch','type':'POST','dataType':'json','data':search,'success':function(json,textStatus){if(typeof(json)=='undefined'||!json)return;if(json.success){if(search.edit_search&&search.lead_id){window.location='/backend/leads/lead/searches/?id='+search.lead_id;}else if(search.saved_search_id&&search.search_by=='map'){window.location='/idx/map/'+search.saved_search_id+'/';}else if(search.saved_search_id){window.location='/idx/search/'+search.saved_search_id+'/';}}else if(json.error){alert(json.error);}}});return;};(function(){$('input, textarea').placeholder();$('.photo').Images({onComplete:function(){$('.listings.flowgrid').eqHeight();}});$('.communities-nav ul').Splitlist();$('nav').each(function(){var $this=$(this),$links=$(this).find('ul');$this.find('h4').bind(BREW.events.click,function(){if($links.hasClass('hidden-phone')){$links.removeClass('hidden-phone');}else{$links.addClass('hidden-phone');}});});$('a.popup').on(BREW.events.click,function(){var $this=$(this),href=$this.attr('href'),options=$this.data('popup');$.Window($.extend(options,{'iframe':href}));return false;});setTimeout(function(){$('.listings.flowgrid').eqHeight();},0);$(window).bind('smartresize',function(){$('.listings.flowgrid').children().css('min-height','auto');$('.listings.flowgrid').eqHeight();});$('.idx-listing-status').change(function(){var feed='glvar';switch($(this).val()){case'':case'active':case'pending':break;default:feed='glvar_sold';}
$('.idx-hidden-status').val(feed);});})();
